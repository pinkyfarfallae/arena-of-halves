"use strict";(self.webpackChunkarena_of_halves=self.webpackChunkarena_of_halves||[]).push([[2],{2(e,t,r){r.r(t),r.d(t,{default:()=>S});var n=r(37),o=r(555),c=r(43),a=r(230),u=r(408),s=r(579);const i=(1+Math.sqrt(5))/2,l=1/i,f=[[1,1,1],[1,1,-1],[1,-1,1],[1,-1,-1],[-1,1,1],[-1,1,-1],[-1,-1,1],[-1,-1,-1],[0,l,i],[0,l,-i],[0,-l,i],[0,-l,-i],[l,i,0],[l,-i,0],[-l,i,0],[-l,-i,0],[i,0,l],[i,0,-l],[-i,0,l],[-i,0,-l]].map(e=>[.9*e[0],.9*e[1],.9*e[2]]),m=[[0,8,10,2,16],[0,16,17,1,12],[0,12,14,4,8],[1,17,3,11,9],[1,9,5,14,12],[2,10,6,15,13],[2,13,3,17,16],[3,13,15,7,11],[4,14,5,19,18],[4,18,6,10,8],[5,9,11,7,19],[6,18,19,7,15]],p=m.map(e=>e.map(e=>f[e])),h=12;const d=p.map(e=>function(e,t,r){const n=new u.Vector3(...e),o=new u.Vector3(...t),c=new u.Vector3(...r);return o.sub(n).cross(c.sub(new u.Vector3(...e))).normalize()}(e[0],e[1],e[2])),w=p.map(e=>{const t=e.reduce((e,t)=>e+t[0],0)/5,r=e.reduce((e,t)=>e+t[1],0)/5,n=e.reduce((e,t)=>e+t[2],0)/5;return new u.Vector3(t,r,n)}),y=(()=>{const e=new Array(h).fill(0),t=new Set;let r=1;for(let n=0;n<h;n++){if(t.has(n))continue;let o=-1,c=1/0;for(let e=n+1;e<h;e++){if(t.has(e))continue;const r=w[n].dot(w[e]);r<c&&(c=r,o=e)}e[n]=r,e[o]=13-r,t.add(n),t.add(o),r++}return e})(),M=(()=>{const e=new Set,t=[];return m.forEach(r=>{for(let n=0;n<5;n++){const o=r[n],c=r[(n+1)%5],a="".concat(Math.min(o,c),"-").concat(Math.max(o,c));e.has(a)||(e.add(a),t.push([f[o],f[c]]))}}),t})(),x=Array.from({length:5},(e,t)=>{const r=-Math.PI/2+2*Math.PI*t/5;return[.5+.45*Math.cos(r),.5+.45*Math.sin(r)]}),g=[.5,.5],R={};p.forEach((e,t)=>{const r=d[t],n=w[t],o=new u.Vector3(e[0][0]-n.x,e[0][1]-n.y,e[0][2]-n.z).normalize(),c=(new u.Vector3).crossVectors(o,r).normalize(),a=(new u.Matrix4).makeBasis(c,o,r).transpose();R[y[t]]=(new u.Quaternion).setFromRotationMatrix(a)});const b=new u.Vector3(0,0,1),A=Math.min(...f.map(e=>e[1])),V=Math.max(...f.map(e=>e[1]));function j(e){const t=e.match(/rgb\((\d+),\s*(\d+),\s*(\d+)\)/);if(t)return[+t[1],+t[2],+t[3]];const r=e.replace("#",""),n=parseInt(3===r.length?r.split("").map(e=>e+e).join(""):r,16);return[n>>16&255,n>>8&255,255&n]}function k(e){const t=function(e){const[t,r,n]=j(e).map(e=>{const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)});return.2126*t+.7152*r+.0722*n}(e);return t>.85?e:t>.4?"#000000":"#ffffff"}function v(e,t){const r=new u.BufferGeometry,n=e.reduce((e,t)=>e+t[0],0)/5,o=e.reduce((e,t)=>e+t[1],0)/5,c=e.reduce((e,t)=>e+t[2],0)/5,a=[],s=[],i=[];for(let u=0;u<5;u++){const r=(u+1)%5;a.push(n,o,c,...e[u],...e[r]),s.push(t.x,t.y,t.z,t.x,t.y,t.z,t.x,t.y,t.z),i.push(...g,...x[u],...x[r])}return r.setAttribute("position",new u.BufferAttribute(new Float32Array(a),3)),r.setAttribute("normal",new u.BufferAttribute(new Float32Array(s),3)),r.setAttribute("uv",new u.BufferAttribute(new Float32Array(i),2)),r}function z(e,t){const r=512,n=document.createElement("canvas");n.width=r,n.height=r;const o=n.getContext("2d");o.fillStyle=t,o.fillRect(0,0,r,r),o.save(),o.translate(256,256),o.scale(-1,-1);const c=k(t);o.fillStyle=c,o.font="bold ".concat(e.length>1?100:130,"px sans-serif"),o.textAlign="center",o.textBaseline="middle",o.fillText(e,0,0),o.restore();const a=new u.CanvasTexture(n);return a.needsUpdate=!0,a}function B(e,t,r,n){const o=new u.Vector3(...e),c=new u.Vector3(...t),a=o.distanceTo(c),s=new u.CylinderGeometry(r,r,a,8,1),i=(e[1]-A)/(V-A),l=(t[1]-A)/(V-A),f=s.attributes.position,m=new Float32Array(3*f.count);for(let u=0;u<f.count;u++){const e=.5+.45*(i+(l-i)*((f.getY(u)+a/2)/a));m[3*u]=n.r*e,m[3*u+1]=n.g*e,m[3*u+2]=n.b*e}return s.setAttribute("color",new u.BufferAttribute(m,3)),s}function C(e){let{rollTrigger:t,onResult:r,primary:n,fixedResult:i}=e;const l=(0,c.useRef)(null),m=(0,c.useRef)(0),w=(0,c.useRef)(!1),x=(0,c.useRef)(!1),g=(0,c.useRef)(0),A=(0,c.useRef)(new u.Vector3(1,1,0).normalize()),V=(0,c.useRef)(8),k=(0,c.useRef)(0),C=(0,c.useRef)(new u.Quaternion),S=(0,c.useRef)(new u.Quaternion),q=(0,c.useRef)(0),F=(0,c.useRef)(!1),T=(0,c.useRef)(0),Q=(0,c.useMemo)(()=>new u.Color(function(e,t){const[r,n,o]=j(e),c=e=>Math.round(e*(1-t));return"rgb(".concat(c(r),",").concat(c(n),",").concat(c(o),")")}(n,.1)),[n]),E=(0,c.useRef)(new Array(h).fill(null)),I=(0,c.useRef)(new u.Vector3),_=(0,c.useMemo)(()=>p.map((e,t)=>({geometry:v(e,d[t]),texture:z(String(y[t]),n)})),[n]),D=(0,c.useMemo)(()=>M.map(e=>{let[t,r]=e;return(0,o.A)({geo:B(t,r,.03,Q)},function(e,t){const r=new u.Vector3(...e),n=new u.Vector3(...t),o=r.clone().add(n).multiplyScalar(.5),c=n.clone().sub(r).normalize();return{pos:o,quat:(new u.Quaternion).setFromUnitVectors(new u.Vector3(0,1,0),c)}}(t,r))}),[Q]),G=(0,c.useMemo)(()=>new u.SphereGeometry(.03,8,8),[]);(0,c.useEffect)(()=>{if(0===t)return;if(t===m.current)return;m.current=t,w.current=!1,x.current=!0,g.current=0;const e=Math.random()<.5?-1:1,r=Math.random()<.5?-1:1,n=Math.random()<.5?-1:1;A.current.set(e*(.5+.5*Math.random()),r*(.5+.5*Math.random()),n*(.5+.5*Math.random())).normalize(),V.current=14+4*Math.random(),k.current=null!==i&&void 0!==i?i:Math.floor(Math.random()*h)+1,C.current.copy(R[k.current])},[t]);return(0,a.D)((e,t)=>{if(!l.current)return;if((()=>{if(!l.current)return;let e=0;if(F.current&&T.current>0){const t=performance.now()/1e3-T.current,r=Math.min(t/.3,1);e=1-r,r>=1&&(F.current=!1);const n=1+.08*Math.sin(r*Math.PI);l.current.scale.setScalar(n)}for(let t=0;t<h;t++){const r=E.current[t];if(!r)continue;I.current.copy(d[t]).applyQuaternion(l.current.quaternion);const n=I.current.dot(b);let o=.55+.45*Math.max(0,n);e>0&&(o+=(2-o)*e*.6),r.material.color.setScalar(o)}})(),!x.current)return;0===g.current&&(g.current=performance.now()/1e3,q.current=0);const n=performance.now()/1e3-g.current;if(n<1.5){const e=n/1.5,r=Math.pow(1-e,1.5);l.current.rotateOnAxis(A.current,V.current*r*t)}else{0===q.current&&(q.current=performance.now()/1e3,S.current.copy(l.current.quaternion));const e=performance.now()/1e3-q.current,t=Math.min(e/.3,1),n=1-Math.pow(1-t,3);l.current.quaternion.copy(S.current).slerp(C.current,n),t>=1&&(x.current=!1,l.current.quaternion.copy(C.current),w.current||(w.current=!0,F.current=!0,T.current=performance.now()/1e3,r(k.current)))}}),(0,s.jsxs)("group",{ref:l,position:[0,-.15,0],children:[_.map((e,t)=>(0,s.jsx)("mesh",{ref:e=>{E.current[t]=e},geometry:e.geometry,children:(0,s.jsx)("meshBasicMaterial",{map:e.texture})},t)),D.map((e,t)=>(0,s.jsx)("mesh",{geometry:e.geo,position:e.pos,quaternion:e.quat,children:(0,s.jsx)("meshBasicMaterial",{vertexColors:!0})},"edge-".concat(t))),f.map((e,t)=>(0,s.jsx)("mesh",{geometry:G,position:e,children:(0,s.jsx)("meshBasicMaterial",{color:Q})},"corner-".concat(t)))]})}function S(e){let{rollTrigger:t,onResult:r,onClick:o,primary:c,primaryDark:a,fixedResult:u}=e;return(0,s.jsxs)(n.Hl,{flat:!0,camera:{position:[0,0,5.5],fov:40},gl:{alpha:!0,antialias:!0},style:{background:"transparent",cursor:"pointer"},onClick:o,children:[(0,s.jsx)("ambientLight",{intensity:.55,color:"#ffffff"}),(0,s.jsx)("directionalLight",{position:[0,0,5],intensity:.45,color:"#ffffff"}),(0,s.jsx)("directionalLight",{position:[3,5,5],intensity:.15,color:"#ffffff"}),(0,s.jsx)(C,{rollTrigger:t,onResult:r,primary:c,primaryDark:a,fixedResult:u})]})}}}]);
//# sourceMappingURL=2.e5b6f828.chunk.js.map