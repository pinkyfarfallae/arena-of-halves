"use strict";(self.webpackChunkarena_of_halves=self.webpackChunkarena_of_halves||[]).push([[485],{485(e,r,n){n.r(r),n.d(r,{default:()=>R});var t=n(37),o=n(555),c=n(43),a=n(230),u=n(408),s=n(579);const i=.85,l=[[-i,-i,-i],[-i,-i,i],[-i,i,-i],[-i,i,i],[i,-i,-i],[i,-i,i],[i,i,-i],[i,i,i]],f=[[0,1],[1,5],[5,4],[4,0],[2,3],[3,7],[7,6],[6,2],[0,2],[1,3],[4,6],[5,7]],m=[new u.Vector3(1,0,0),new u.Vector3(-1,0,0),new u.Vector3(0,1,0),new u.Vector3(0,-1,0),new u.Vector3(0,0,1),new u.Vector3(0,0,-1)],p=[2,5,3,4,1,6],h={1:new u.Quaternion,2:(new u.Quaternion).setFromAxisAngle(new u.Vector3(0,1,0),-Math.PI/2),3:(new u.Quaternion).setFromAxisAngle(new u.Vector3(1,0,0),Math.PI/2),4:(new u.Quaternion).setFromAxisAngle(new u.Vector3(1,0,0),-Math.PI/2),5:(new u.Quaternion).setFromAxisAngle(new u.Vector3(0,1,0),Math.PI/2),6:(new u.Quaternion).setFromAxisAngle(new u.Vector3(0,1,0),Math.PI)},w=new u.Vector3(0,0,1);function d(e){const r=e.match(/rgb\((\d+),\s*(\d+),\s*(\d+)\)/);if(r)return[+r[1],+r[2],+r[3]];const n=e.replace("#",""),t=parseInt(3===n.length?n.split("").map(e=>e+e).join(""):n,16);return[t>>16&255,t>>8&255,255&t]}function g(e){const r=function(e){const[r,n,t]=d(e).map(e=>{const r=e/255;return r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4)});return.2126*r+.7152*n+.0722*t}(e);return r>.85?e:r>.4?"#000000":"#ffffff"}function M(e,r){const n=512,t=document.createElement("canvas");t.width=n,t.height=n;const o=t.getContext("2d");o.fillStyle=r,o.fillRect(0,0,n,n);const c=g(r);o.fillStyle=c,o.font="bold 180px sans-serif",o.textAlign="center",o.textBaseline="middle",o.fillText(String(e),256,256);const a=new u.CanvasTexture(t);return a.needsUpdate=!0,a}function x(e,r,n,t){const o=new u.Vector3(...e),c=new u.Vector3(...r),a=o.distanceTo(c),s=new u.CylinderGeometry(n,n,a,8,1),l=(e[1]+i)/1.7,f=(r[1]+i)/1.7,m=s.attributes.position,p=new Float32Array(3*m.count);for(let u=0;u<m.count;u++){const e=.5+.45*(l+(f-l)*((m.getY(u)+a/2)/a));p[3*u]=t.r*e,p[3*u+1]=t.g*e,p[3*u+2]=t.b*e}return s.setAttribute("color",new u.BufferAttribute(p,3)),s}function y(e){let{rollTrigger:r,onResult:n,primary:t,primaryDark:i,fixedResult:g}=e;const y=(0,c.useRef)(null),R=(0,c.useRef)(0),V=(0,c.useRef)(!1),A=(0,c.useRef)(!1),b=(0,c.useRef)(0),j=(0,c.useRef)(new u.Vector3(1,1,0).normalize()),k=(0,c.useRef)(8),Q=(0,c.useRef)(0),C=(0,c.useRef)(new u.Quaternion),v=(0,c.useRef)(new u.Quaternion),q=(0,c.useRef)(0),F=(0,c.useRef)(!1),I=(0,c.useRef)(0),S=(0,c.useMemo)(()=>new u.Color(function(e,r){const[n,t,o]=d(e),c=e=>Math.round(e*(1-r));return"rgb(".concat(c(n),",").concat(c(t),",").concat(c(o),")")}(t,-.35)),[t]),B=(0,c.useRef)(new u.Vector3),P=(0,c.useMemo)(()=>new u.BoxGeometry(1.7,1.7,1.7),[]),T=(0,c.useMemo)(()=>p.map(e=>new u.MeshBasicMaterial({map:M(e,t)})),[t]),D=(0,c.useMemo)(()=>f.map(e=>{let[r,n]=e;return(0,o.A)({geo:x(l[r],l[n],.02,S)},function(e,r){const n=new u.Vector3(...e),t=new u.Vector3(...r),o=n.clone().add(t).multiplyScalar(.5),c=t.clone().sub(n).normalize();return{pos:o,quat:(new u.Quaternion).setFromUnitVectors(new u.Vector3(0,1,0),c)}}(l[r],l[n]))}),[S]),_=(0,c.useMemo)(()=>new u.SphereGeometry(.02,8,8),[]);(0,c.useEffect)(()=>{if(0===r)return;if(r===R.current)return;R.current=r,V.current=!1,A.current=!0,b.current=0;const e=Math.random()<.5?-1:1,n=Math.random()<.5?-1:1,t=Math.random()<.5?-1:1;j.current.set(e*(.5+.5*Math.random()),n*(.5+.5*Math.random()),t*(.5+.5*Math.random())).normalize(),k.current=14+4*Math.random(),Q.current=null!==g&&void 0!==g?g:Math.floor(6*Math.random())+1,C.current.copy(h[Q.current])},[r]);return(0,a.D)((e,r)=>{if(!y.current)return;if((()=>{if(!y.current)return;let e=0;if(F.current&&I.current>0){const r=performance.now()/1e3-I.current,n=Math.min(r/.3,1);e=1-n,n>=1&&(F.current=!1);const t=1+.08*Math.sin(n*Math.PI);y.current.scale.setScalar(t)}for(let r=0;r<6;r++){B.current.copy(m[r]).applyQuaternion(y.current.quaternion);const n=B.current.dot(w);let t=.55+.45*Math.max(0,n);e>0&&(t+=(2-t)*e*.6),T[r].color.setScalar(t)}})(),!A.current)return;0===b.current&&(b.current=performance.now()/1e3,q.current=0);const t=performance.now()/1e3-b.current;if(t<1.5){const e=t/1.5,n=Math.pow(1-e,1.5);y.current.rotateOnAxis(j.current,k.current*n*r)}else{0===q.current&&(q.current=performance.now()/1e3,v.current.copy(y.current.quaternion));const e=performance.now()/1e3-q.current,r=Math.min(e/.3,1),t=1-Math.pow(1-r,3);y.current.quaternion.copy(v.current).slerp(C.current,t),r>=1&&(A.current=!1,y.current.quaternion.copy(C.current),V.current||(V.current=!0,F.current=!0,I.current=performance.now()/1e3,n(Q.current)))}}),(0,s.jsxs)("group",{ref:y,position:[0,-.1,0],children:[(0,s.jsx)("mesh",{geometry:P,material:T}),D.map((e,r)=>(0,s.jsx)("mesh",{geometry:e.geo,position:e.pos,quaternion:e.quat,children:(0,s.jsx)("meshBasicMaterial",{vertexColors:!0})},"edge-".concat(r))),l.map((e,r)=>(0,s.jsx)("mesh",{geometry:_,position:e,children:(0,s.jsx)("meshBasicMaterial",{color:S})},"corner-".concat(r)))]})}function R(e){let{rollTrigger:r,onResult:n,onClick:o,primary:c,primaryDark:a,fixedResult:u}=e;return(0,s.jsxs)(t.Hl,{flat:!0,camera:{position:[0,0,5.5],fov:40},gl:{alpha:!0,antialias:!0},style:{background:"transparent",cursor:"pointer"},onClick:o,children:[(0,s.jsx)("ambientLight",{intensity:.55,color:"#ffffff"}),(0,s.jsx)("directionalLight",{position:[0,0,5],intensity:.45,color:"#ffffff"}),(0,s.jsx)("directionalLight",{position:[3,5,5],intensity:.15,color:"#ffffff"}),(0,s.jsx)(y,{rollTrigger:r,onResult:n,primary:c,primaryDark:a,fixedResult:u})]})}}}]);
//# sourceMappingURL=485.a8418e11.chunk.js.map