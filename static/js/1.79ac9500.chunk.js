"use strict";(self.webpackChunkarena_of_halves=self.webpackChunkarena_of_halves||[]).push([[1],[,(e,t,r)=>{r.r(t),r.d(t,{default:()=>F});var n=r(37),o=r(555),c=r(43),a=r(230),u=r(408),s=r(579);const i=(1+Math.sqrt(5))/2,f=.85,l=[[0,1,i],[0,1,-i],[0,-1,i],[0,-1,-i],[1,i,0],[1,-i,0],[-1,i,0],[-1,-i,0],[i,0,1],[i,0,-1],[-i,0,1],[-i,0,-1]].map(e=>[e[0]*f,e[1]*f,e[2]*f]),m=[[0,2,8],[0,8,4],[0,4,6],[0,6,10],[0,10,2],[3,1,9],[3,9,5],[3,5,7],[3,7,11],[3,11,1],[2,5,8],[8,9,4],[4,1,6],[6,11,10],[10,7,2],[5,2,7],[9,8,5],[1,4,9],[11,6,1],[7,10,11]],p=m.map(e=>e.map(e=>l[e])),h=20;const w=p.map(e=>function(e,t,r){const n=new u.Vector3(...e),o=new u.Vector3(...t),c=new u.Vector3(...r);return o.sub(n).cross(c.sub(new u.Vector3(...e))).normalize()}(e[0],e[1],e[2])),d=p.map(e=>new u.Vector3((e[0][0]+e[1][0]+e[2][0])/3,(e[0][1]+e[1][1]+e[2][1])/3,(e[0][2]+e[1][2]+e[2][2])/3));p.forEach((e,t)=>{if(d[t].dot(w[t])<0){const r=e[1];e[1]=e[2],e[2]=r;const n=m[t][1];m[t][1]=m[t][2],m[t][2]=n,w[t].negate()}});const y=(()=>{const e=new Array(h).fill(0),t=new Set;let r=1;for(let n=0;n<h;n++){if(t.has(n))continue;let o=-1,c=1/0;for(let e=n+1;e<h;e++){if(t.has(e))continue;const r=d[n].dot(d[e]);r<c&&(c=r,o=e)}e[n]=r,e[o]=21-r,t.add(n),t.add(o),r++}return e})(),x=(()=>{const e=new Set,t=[];return m.forEach(r=>{for(let n=0;n<3;n++){const o=r[n],c=r[(n+1)%3],a="".concat(Math.min(o,c),"-").concat(Math.max(o,c));e.has(a)||(e.add(a),t.push([l[o],l[c]]))}}),t})(),M={};p.forEach((e,t)=>{const r=w[t],n=d[t],o=new u.Vector3(e[0][0]-n.x,e[0][1]-n.y,e[0][2]-n.z).normalize(),c=(new u.Vector3).crossVectors(o,r).normalize(),a=(new u.Matrix4).makeBasis(c,o,r).transpose();M[y[t]]=(new u.Quaternion).setFromRotationMatrix(a)});const g=.025,R=1.5,b=.3,A=b,V=new u.Vector3(0,0,1),j=Math.min(...l.map(e=>e[1])),k=Math.max(...l.map(e=>e[1]));function z(e){const t=e.match(/rgb\((\d+),\s*(\d+),\s*(\d+)\)/);if(t)return[+t[1],+t[2],+t[3]];const r=e.replace("#",""),n=parseInt(3===r.length?r.split("").map(e=>e+e).join(""):r,16);return[n>>16&255,n>>8&255,255&n]}function B(e){const t=function(e){const[t,r,n]=z(e).map(e=>{const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)});return.2126*t+.7152*r+.0722*n}(e);return t>.85?e:t>.4?"#000000":"#ffffff"}function v(e,t){const r=new u.BufferGeometry,n=new Float32Array([...e[0],...e[1],...e[2]]),o=new Float32Array([t.x,t.y,t.z,t.x,t.y,t.z,t.x,t.y,t.z]),c=new Float32Array([.5,1,0,0,1,0]);return r.setAttribute("position",new u.BufferAttribute(n,3)),r.setAttribute("normal",new u.BufferAttribute(o,3)),r.setAttribute("uv",new u.BufferAttribute(c,2)),r}function C(e,t){const r=512,n=document.createElement("canvas");n.width=r,n.height=r;const o=n.getContext("2d");o.fillStyle=t,o.fillRect(0,0,r,r);const c=B(t);o.fillStyle=c,o.font="bold ".concat(e.length>1?100:140,"px sans-serif"),o.textAlign="center",o.textBaseline="middle",o.fillText(e,256,1024/3);const a=new u.CanvasTexture(n);return a.needsUpdate=!0,a}function S(e,t,r,n){const o=new u.Vector3(...e),c=new u.Vector3(...t),a=o.distanceTo(c),s=new u.CylinderGeometry(r,r,a,8,1),i=(e[1]-j)/(k-j),f=(t[1]-j)/(k-j),l=s.attributes.position,m=new Float32Array(3*l.count);for(let u=0;u<l.count;u++){const e=.5+.45*(i+(f-i)*((l.getY(u)+a/2)/a));m[3*u]=n.r*e,m[3*u+1]=n.g*e,m[3*u+2]=n.b*e}return s.setAttribute("color",new u.BufferAttribute(m,3)),s}function q(e){let{rollTrigger:t,onResult:r,primary:n,fixedResult:i}=e;const f=(0,c.useRef)(null),m=(0,c.useRef)(0),d=(0,c.useRef)(!1),j=(0,c.useRef)(!1),k=(0,c.useRef)(0),B=(0,c.useRef)(new u.Vector3(1,1,0).normalize()),q=(0,c.useRef)(8),F=(0,c.useRef)(0),T=(0,c.useRef)(new u.Quaternion),E=(0,c.useRef)(new u.Quaternion),Q=(0,c.useRef)(0),_=(0,c.useRef)(!1),D=(0,c.useRef)(0),G=(0,c.useMemo)(()=>new u.Color(function(e,t){const[r,n,o]=z(e),c=e=>Math.round(e*(1-t));return"rgb(".concat(c(r),",").concat(c(n),",").concat(c(o),")")}(n,.3)),[n]),L=(0,c.useRef)(new Array(h).fill(null)),I=(0,c.useRef)(new u.Vector3),U=(0,c.useMemo)(()=>p.map((e,t)=>({geometry:v(e,w[t]),texture:C(String(y[t]),n)})),[n]),H=(0,c.useMemo)(()=>x.map(e=>{let[t,r]=e;return(0,o.A)({geo:S(t,r,g,G)},function(e,t){const r=new u.Vector3(...e),n=new u.Vector3(...t),o=r.clone().add(n).multiplyScalar(.5),c=n.clone().sub(r).normalize();return{pos:o,quat:(new u.Quaternion).setFromUnitVectors(new u.Vector3(0,1,0),c)}}(t,r))}),[G]),O=(0,c.useMemo)(()=>new u.SphereGeometry(g,8,8),[]);(0,c.useEffect)(()=>{if(0===t)return;if(t===m.current)return;m.current=t,d.current=!1,j.current=!0,k.current=0;const e=Math.random()<.5?-1:1,r=Math.random()<.5?-1:1,n=Math.random()<.5?-1:1;B.current.set(e*(.5+.5*Math.random()),r*(.5+.5*Math.random()),n*(.5+.5*Math.random())).normalize(),q.current=14+4*Math.random(),F.current=null!==i&&void 0!==i?i:Math.floor(Math.random()*h)+1,T.current.copy(M[F.current])},[t]);return(0,a.D)((e,t)=>{if(!f.current)return;if((()=>{if(!f.current)return;let e=0;if(_.current&&D.current>0){const t=performance.now()/1e3-D.current,r=Math.min(t/A,1);e=1-r,r>=1&&(_.current=!1);const n=1+.08*Math.sin(r*Math.PI);f.current.scale.setScalar(n)}for(let t=0;t<h;t++){const r=L.current[t];if(!r)continue;I.current.copy(w[t]).applyQuaternion(f.current.quaternion);const n=I.current.dot(V);let o=.55+.45*Math.max(0,n);e>0&&(o+=(2-o)*e*.6),r.material.color.setScalar(o)}})(),!j.current)return;0===k.current&&(k.current=performance.now()/1e3,Q.current=0);const n=performance.now()/1e3-k.current;if(n<R){const e=n/R,r=Math.pow(1-e,1.5);f.current.rotateOnAxis(B.current,q.current*r*t)}else{0===Q.current&&(Q.current=performance.now()/1e3,E.current.copy(f.current.quaternion));const e=performance.now()/1e3-Q.current,t=Math.min(e/b,1),n=1-Math.pow(1-t,3);f.current.quaternion.copy(E.current).slerp(T.current,n),t>=1&&(j.current=!1,f.current.quaternion.copy(T.current),d.current||(d.current=!0,_.current=!0,D.current=performance.now()/1e3,r(F.current)))}}),(0,s.jsxs)("group",{ref:f,position:[0,-.15,0],children:[U.map((e,t)=>(0,s.jsx)("mesh",{ref:e=>{L.current[t]=e},geometry:e.geometry,children:(0,s.jsx)("meshBasicMaterial",{map:e.texture})},t)),H.map((e,t)=>(0,s.jsx)("mesh",{geometry:e.geo,position:e.pos,quaternion:e.quat,children:(0,s.jsx)("meshBasicMaterial",{vertexColors:!0})},"edge-".concat(t))),l.map((e,t)=>(0,s.jsx)("mesh",{geometry:O,position:e,children:(0,s.jsx)("meshBasicMaterial",{color:G})},"corner-".concat(t)))]})}function F(e){let{rollTrigger:t,onResult:r,onClick:o,primary:c,primaryDark:a,fixedResult:u}=e;return(0,s.jsxs)(n.Hl,{flat:!0,camera:{position:[0,0,5.5],fov:40},gl:{alpha:!0,antialias:!0},style:{background:"transparent",cursor:"pointer"},onClick:o,children:[(0,s.jsx)("ambientLight",{intensity:.55,color:"#ffffff"}),(0,s.jsx)("directionalLight",{position:[0,0,5],intensity:.45,color:"#ffffff"}),(0,s.jsx)("directionalLight",{position:[3,5,5],intensity:.15,color:"#ffffff"}),(0,s.jsx)(q,{rollTrigger:t,onResult:r,primary:c,primaryDark:a,fixedResult:u})]})}}]]);
//# sourceMappingURL=1.79ac9500.chunk.js.map