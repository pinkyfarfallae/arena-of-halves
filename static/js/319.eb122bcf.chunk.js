"use strict";(self.webpackChunkarena_of_halves=self.webpackChunkarena_of_halves||[]).push([[319],{319(e,r,t){t.r(r),t.d(r,{default:()=>v});var n=t(37),o=t(555),c=t(43),a=t(230),u=t(408),s=t(579);const i=2*Math.PI/5,l=[0,1.65,0],f=[0,-1.65,0],m=Array.from({length:5},(e,r)=>{const t=r*i;return[1.5*Math.cos(t),0,1.5*Math.sin(t)]}),p=[l,f,...m],h=[...Array.from({length:5},(e,r)=>[l,m[(r+1)%5],m[r]]),...Array.from({length:5},(e,r)=>[f,m[r],m[(r+1)%5]])],w=[1,3,5,7,9,2,4,6,8,10];const d=h.map(e=>function(e,r,t){const n=new u.Vector3(...e),o=new u.Vector3(...r),c=new u.Vector3(...t);return o.sub(n).cross(c.sub(new u.Vector3(...e))).normalize()}(e[0],e[1],e[2])),y=[...Array.from({length:5},(e,r)=>[l,m[r]]),...Array.from({length:5},(e,r)=>[f,m[r]]),...Array.from({length:5},(e,r)=>[m[r],m[(r+1)%5]])],g=h.map((e,r)=>{const t=d[r],n=(e[0][0]+e[1][0]+e[2][0])/3,o=(e[0][1]+e[1][1]+e[2][1])/3,c=(e[0][2]+e[1][2]+e[2][2])/3,a=new u.Vector3(e[0][0]-n,e[0][1]-o,e[0][2]-c).normalize(),s=(new u.Vector3).crossVectors(a,t).normalize(),i=(new u.Matrix4).makeBasis(s,a,t).transpose();return(new u.Quaternion).setFromRotationMatrix(i)}),x=new u.Vector3(0,0,1),M=Math.min(...p.map(e=>e[1])),R=Math.max(...p.map(e=>e[1]));function A(e){const r=e.match(/rgb\((\d+),\s*(\d+),\s*(\d+)\)/);if(r)return[+r[1],+r[2],+r[3]];const t=e.replace("#",""),n=parseInt(3===t.length?t.split("").map(e=>e+e).join(""):t,16);return[n>>16&255,n>>8&255,255&n]}function b(e){const r=function(e){const[r,t,n]=A(e).map(e=>{const r=e/255;return r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4)});return.2126*r+.7152*t+.0722*n}(e);return r>.85?e:r>.4?"#000000":"#ffffff"}function V(e,r){const t=new u.BufferGeometry,n=new Float32Array([...e[0],...e[1],...e[2]]),o=new Float32Array([r.x,r.y,r.z,r.x,r.y,r.z,r.x,r.y,r.z]),c=new Float32Array([.5,1,0,0,1,0]);return t.setAttribute("position",new u.BufferAttribute(n,3)),t.setAttribute("normal",new u.BufferAttribute(o,3)),t.setAttribute("uv",new u.BufferAttribute(c,2)),t}function j(e,r){const t=512,n=document.createElement("canvas");n.width=t,n.height=t;const o=n.getContext("2d");o.fillStyle=r,o.fillRect(0,0,t,t);const c=b(r);o.fillStyle=c,o.font="bold ".concat(e.length>2?100:140,"px sans-serif"),o.textAlign="center",o.textBaseline="middle",o.fillText(e,256,1024/3);const a=new u.CanvasTexture(n);return a.needsUpdate=!0,a}function k(e,r,t,n){const o=new u.Vector3(...e),c=new u.Vector3(...r),a=o.distanceTo(c),s=new u.CylinderGeometry(t,t,a,8,1),i=(e[1]-M)/(R-M),l=(r[1]-M)/(R-M),f=s.attributes.position,m=new Float32Array(3*f.count);for(let u=0;u<f.count;u++){const e=.5+.45*(i+(l-i)*((f.getY(u)+a/2)/a));m[3*u]=n.r*e,m[3*u+1]=n.g*e,m[3*u+2]=n.b*e}return s.setAttribute("color",new u.BufferAttribute(m,3)),s}function B(e){let{rollTrigger:r,onResult:t,primary:n,faceLabels:i,fixedResult:l}=e;const f=(0,c.useRef)(null),m=(0,c.useRef)(0),M=(0,c.useRef)(!1),R=(0,c.useRef)(!1),b=(0,c.useRef)(0),B=(0,c.useRef)(new u.Vector3(1,1,0).normalize()),v=(0,c.useRef)(8),z=(0,c.useRef)(0),C=(0,c.useRef)(new u.Quaternion),q=(0,c.useRef)(new u.Quaternion),S=(0,c.useRef)(0),F=(0,c.useRef)(!1),T=(0,c.useRef)(0),Q=null!==i&&void 0!==i?i:w.map(String),L=(0,c.useMemo)(()=>new u.Color(function(e,r){const[t,n,o]=A(e),c=e=>Math.round(e*(1-r));return"rgb(".concat(c(t),",").concat(c(n),",").concat(c(o),")")}(n,.35)),[n]),_=(0,c.useRef)(new Array(10).fill(null)),D=(0,c.useRef)(new u.Vector3),G=(0,c.useMemo)(()=>h.map((e,r)=>({geometry:V(e,d[r]),texture:j(Q[r],n)})),[n,Q]),I=(0,c.useMemo)(()=>y.map(e=>{let[r,t]=e;return(0,o.A)({geo:k(r,t,.035,L)},function(e,r){const t=new u.Vector3(...e),n=new u.Vector3(...r),o=t.clone().add(n).multiplyScalar(.5),c=n.clone().sub(t).normalize();return{pos:o,quat:(new u.Quaternion).setFromUnitVectors(new u.Vector3(0,1,0),c)}}(r,t))}),[L]),E=(0,c.useMemo)(()=>new u.SphereGeometry(.035,8,8),[]);(0,c.useEffect)(()=>{if(0===r)return;if(r===m.current)return;m.current=r,M.current=!1,R.current=!0,b.current=0;const e=Math.random()<.5?-1:1,t=Math.random()<.5?-1:1,n=Math.random()<.5?-1:1;B.current.set(e*(.5+.5*Math.random()),t*(.5+.5*Math.random()),n*(.5+.5*Math.random())).normalize(),v.current=14+4*Math.random(),z.current=null!=l?w.indexOf(l):Math.floor(10*Math.random()),C.current.copy(g[z.current])},[r]);return(0,a.D)((e,r)=>{if(!f.current)return;if((()=>{if(!f.current)return;let e=0;if(F.current&&T.current>0){const r=performance.now()/1e3-T.current,t=Math.min(r/.3,1);e=1-t,t>=1&&(F.current=!1);const n=1+.08*Math.sin(t*Math.PI);f.current.scale.setScalar(n)}for(let r=0;r<10;r++){const t=_.current[r];if(!t)continue;D.current.copy(d[r]).applyQuaternion(f.current.quaternion);const n=D.current.dot(x);let o=.55+.45*Math.max(0,n);e>0&&(o+=(2-o)*e*.6),t.material.color.setScalar(o)}})(),!R.current)return;0===b.current&&(b.current=performance.now()/1e3,S.current=0);const n=performance.now()/1e3-b.current;if(n<1.5){const e=n/1.5,t=Math.pow(1-e,1.5);f.current.rotateOnAxis(B.current,v.current*t*r)}else{0===S.current&&(S.current=performance.now()/1e3,q.current.copy(f.current.quaternion));const e=performance.now()/1e3-S.current,r=Math.min(e/.3,1),n=1-Math.pow(1-r,3);f.current.quaternion.copy(q.current).slerp(C.current,n),r>=1&&(R.current=!1,f.current.quaternion.copy(C.current),M.current||(M.current=!0,F.current=!0,T.current=performance.now()/1e3,t(w[z.current])))}}),(0,s.jsxs)("group",{ref:f,position:[0,-.15,0],children:[G.map((e,r)=>(0,s.jsx)("mesh",{ref:e=>{_.current[r]=e},geometry:e.geometry,children:(0,s.jsx)("meshBasicMaterial",{map:e.texture})},r)),I.map((e,r)=>(0,s.jsx)("mesh",{geometry:e.geo,position:e.pos,quaternion:e.quat,children:(0,s.jsx)("meshBasicMaterial",{vertexColors:!0})},"edge-".concat(r))),p.map((e,r)=>(0,s.jsx)("mesh",{geometry:E,position:e,children:(0,s.jsx)("meshBasicMaterial",{color:L})},"corner-".concat(r)))]})}function v(e){let{rollTrigger:r,onResult:t,onClick:o,primary:c,primaryDark:a,fixedResult:u}=e;return(0,s.jsxs)(n.Hl,{flat:!0,camera:{position:[0,0,5.5],fov:40},gl:{alpha:!0,antialias:!0},style:{background:"transparent",cursor:"pointer"},onClick:o,children:[(0,s.jsx)("ambientLight",{intensity:.55,color:"#ffffff"}),(0,s.jsx)("directionalLight",{position:[0,0,5],intensity:.45,color:"#ffffff"}),(0,s.jsx)("directionalLight",{position:[3,5,5],intensity:.15,color:"#ffffff"}),(0,s.jsx)(B,{rollTrigger:r,onResult:t,primary:c,primaryDark:a,fixedResult:u})]})}}}]);
//# sourceMappingURL=319.eb122bcf.chunk.js.map