{"version":3,"file":"static/js/319.282a8fa5.chunk.js","mappings":"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","sources":["components/DiceRoller/D10/TrapezohedronDie.tsx","components/DiceRoller/D10/D10Scene.tsx"],"sourcesContent":["import { useEffect, useMemo, useRef } from 'react';\nimport { useFrame } from '@react-three/fiber';\nimport * as THREE from 'three';\n\ninterface Props {\n  rollTrigger: number;\n  onResult: (result: number) => void;\n  primary: string;\n  primaryDark: string;\n  maxResult?: number;\n  faceLabels?: string[];\n}\n\n/* ── Geometry ──\n   Pentagonal bipyramid: 2 poles + 5 equatorial = 7 vertices, 10 triangular faces, 15 edges.\n   Clean isometric shape — same approach as D8 (octahedron) but with pentagonal cross-section.\n*/\nconst H = 1.65;  // pole half-height\nconst R = 1.5;  // equatorial radius\n\nconst DEG72 = (2 * Math.PI) / 5;\n\nconst TOP: THREE.Vector3Tuple = [0, H, 0];\nconst BOT: THREE.Vector3Tuple = [0, -H, 0];\n\nconst EQ: THREE.Vector3Tuple[] = Array.from({ length: 5 }, (_, i) => {\n  const a = i * DEG72;\n  return [R * Math.cos(a), 0, R * Math.sin(a)] as THREE.Vector3Tuple;\n});\n\nconst ALL_VERTS: THREE.Vector3Tuple[] = [TOP, BOT, ...EQ];\n\n/* ── 10 triangular faces (CCW from outside) ── */\nconst FACES: THREE.Vector3Tuple[][] = [\n  // Upper 5\n  ...Array.from({ length: 5 }, (_, i) => [TOP, EQ[(i + 1) % 5], EQ[i]]),\n  // Lower 5\n  ...Array.from({ length: 5 }, (_, i) => [BOT, EQ[i], EQ[(i + 1) % 5]]),\n];\n\nconst FACE_VALUES = [1, 3, 5, 7, 9, 2, 4, 6, 8, 10];\n\nfunction computeNormal(a: THREE.Vector3Tuple, b: THREE.Vector3Tuple, c: THREE.Vector3Tuple): THREE.Vector3 {\n  const va = new THREE.Vector3(...a);\n  const vb = new THREE.Vector3(...b);\n  const vc = new THREE.Vector3(...c);\n  return vb.sub(va).cross(vc.sub(new THREE.Vector3(...a))).normalize();\n}\n\nconst NORMALS = FACES.map(f => computeNormal(f[0], f[1], f[2]));\n\n/* ── 15 edges ── */\nconst EDGE_PAIRS: [THREE.Vector3Tuple, THREE.Vector3Tuple][] = [\n  ...Array.from({ length: 5 }, (_, i) => [TOP, EQ[i]] as [THREE.Vector3Tuple, THREE.Vector3Tuple]),\n  ...Array.from({ length: 5 }, (_, i) => [BOT, EQ[i]] as [THREE.Vector3Tuple, THREE.Vector3Tuple]),\n  ...Array.from({ length: 5 }, (_, i) => [EQ[i], EQ[(i + 1) % 5]] as [THREE.Vector3Tuple, THREE.Vector3Tuple]),\n];\n\n/* ── Target quaternions with full basis ── */\nconst TARGET_QUATS: THREE.Quaternion[] = FACES.map((verts, fi) => {\n  const normal = NORMALS[fi];\n  const cx = (verts[0][0] + verts[1][0] + verts[2][0]) / 3;\n  const cy = (verts[0][1] + verts[1][1] + verts[2][1]) / 3;\n  const cz = (verts[0][2] + verts[1][2] + verts[2][2]) / 3;\n  const up = new THREE.Vector3(\n    verts[0][0] - cx, verts[0][1] - cy, verts[0][2] - cz,\n  ).normalize();\n  const right = new THREE.Vector3().crossVectors(up, normal).normalize();\n  const m = new THREE.Matrix4().makeBasis(right, up, normal).transpose();\n  return new THREE.Quaternion().setFromRotationMatrix(m);\n});\n\nconst EDGE_RADIUS = 0.035;\nconst SPIN_DURATION = 1.5;\nconst SETTLE_DURATION = 0.3;\nconst FLASH_DURATION = SETTLE_DURATION;\nconst camDir = new THREE.Vector3(0, 0, 1);\n\nconst MIN_Y = Math.min(...ALL_VERTS.map(v => v[1]));\nconst MAX_Y = Math.max(...ALL_VERTS.map(v => v[1]));\n\n/* ── Color helpers ── */\n\nfunction parseColor(color: string): [number, number, number] {\n  const rgbMatch = color.match(/rgb\\((\\d+),\\s*(\\d+),\\s*(\\d+)\\)/);\n  if (rgbMatch) return [+rgbMatch[1], +rgbMatch[2], +rgbMatch[3]];\n  const hex = color.replace('#', '');\n  const n = parseInt(hex.length === 3 ? hex.split('').map(c => c + c).join('') : hex, 16);\n  return [(n >> 16) & 255, (n >> 8) & 255, n & 255];\n}\n\nfunction luminance(color: string): number {\n  const [r, g, b] = parseColor(color).map(c => {\n    const s = c / 255;\n    return s <= 0.03928 ? s / 12.92 : Math.pow((s + 0.055) / 1.055, 2.4);\n  });\n  return 0.2126 * r + 0.7152 * g + 0.0722 * b;\n}\n\nfunction contrastText(bg: string): string {\n  const lum = luminance(bg);\n  if (lum > 0.85) return bg;\n  return lum > 0.4 ? '#000000' : '#ffffff';\n}\n\nfunction darken(color: string, ratio: number): string {\n  const [r, g, b] = parseColor(color);\n  const m = (c: number) => Math.round(c * (1 - ratio));\n  return `rgb(${m(r)},${m(g)},${m(b)})`;\n}\n\n/* ── Geometry / texture builders ── */\n\nfunction makeFaceGeo(verts: THREE.Vector3Tuple[], normal: THREE.Vector3): THREE.BufferGeometry {\n  const geo = new THREE.BufferGeometry();\n  const pos = new Float32Array([...verts[0], ...verts[1], ...verts[2]]);\n  const norms = new Float32Array([\n    normal.x, normal.y, normal.z,\n    normal.x, normal.y, normal.z,\n    normal.x, normal.y, normal.z,\n  ]);\n  const uvs = new Float32Array([0.5, 1.0, 0.0, 0.0, 1.0, 0.0]);\n  geo.setAttribute('position', new THREE.BufferAttribute(pos, 3));\n  geo.setAttribute('normal', new THREE.BufferAttribute(norms, 3));\n  geo.setAttribute('uv', new THREE.BufferAttribute(uvs, 2));\n  return geo;\n}\n\nfunction makeFaceTexture(label: string, primary: string): THREE.CanvasTexture {\n  const size = 512;\n  const canvas = document.createElement('canvas');\n  canvas.width = size;\n  canvas.height = size;\n  const ctx = canvas.getContext('2d')!;\n\n  ctx.fillStyle = primary;\n  ctx.fillRect(0, 0, size, size);\n\n  const textColor = contrastText(primary);\n  ctx.fillStyle = textColor;\n  ctx.font = `bold ${label.length > 2 ? 100 : 140}px sans-serif`;\n  ctx.textAlign = 'center';\n  ctx.textBaseline = 'middle';\n  ctx.fillText(label, size / 2, size * 2 / 3);\n\n  const tex = new THREE.CanvasTexture(canvas);\n  tex.needsUpdate = true;\n  return tex;\n}\n\nfunction makeEdgeCylinder(a: THREE.Vector3Tuple, b: THREE.Vector3Tuple, radius: number, baseColor: THREE.Color): THREE.CylinderGeometry {\n  const va = new THREE.Vector3(...a);\n  const vb = new THREE.Vector3(...b);\n  const height = va.distanceTo(vb);\n  const geo = new THREE.CylinderGeometry(radius, radius, height, 8, 1);\n\n  const tA = (a[1] - MIN_Y) / (MAX_Y - MIN_Y);\n  const tB = (b[1] - MIN_Y) / (MAX_Y - MIN_Y);\n  const positions = geo.attributes.position;\n  const colors = new Float32Array(positions.count * 3);\n\n  for (let i = 0; i < positions.count; i++) {\n    const y = positions.getY(i);\n    const along = (y + height / 2) / height;\n    const tint = 0.5 + 0.45 * (tA + (tB - tA) * along);\n    colors[i * 3] = baseColor.r * tint;\n    colors[i * 3 + 1] = baseColor.g * tint;\n    colors[i * 3 + 2] = baseColor.b * tint;\n  }\n\n  geo.setAttribute('color', new THREE.BufferAttribute(colors, 3));\n  return geo;\n}\n\nfunction edgeTransform(a: THREE.Vector3Tuple, b: THREE.Vector3Tuple): { pos: THREE.Vector3; quat: THREE.Quaternion } {\n  const va = new THREE.Vector3(...a);\n  const vb = new THREE.Vector3(...b);\n  const mid = va.clone().add(vb).multiplyScalar(0.5);\n  const dir = vb.clone().sub(va).normalize();\n  const quat = new THREE.Quaternion().setFromUnitVectors(new THREE.Vector3(0, 1, 0), dir);\n  return { pos: mid, quat };\n}\n\n/* ── Component ── */\n\nexport default function TrapezohedronDie({\n  rollTrigger, onResult, primary,\n  faceLabels,\n}: Props) {\n  const groupRef = useRef<THREE.Group>(null);\n  const prevTrigger = useRef(rollTrigger);\n  const hasReported = useRef(false);\n\n  const spinning = useRef(false);\n  const spinStart = useRef(0);\n  const spinAxis = useRef(new THREE.Vector3(1, 1, 0).normalize());\n  const spinSpeed = useRef(8);\n  const targetFaceIdx = useRef(0);\n  const targetQuat = useRef(new THREE.Quaternion());\n  const settleStartQuat = useRef(new THREE.Quaternion());\n  const settleStart = useRef(0);\n\n  const flashing = useRef(false);\n  const flashStart = useRef(0);\n\n  const labels = faceLabels ?? FACE_VALUES.map(String);\n  const edgeBaseColor = useMemo(() => new THREE.Color(darken(primary, 0.35)), [primary]);\n\n  const faceMeshRefs = useRef<(THREE.Mesh | null)[]>(new Array(10).fill(null));\n  const worldNormal = useRef(new THREE.Vector3());\n\n  const faceData = useMemo(() =>\n    FACES.map((verts, fi) => ({\n      geometry: makeFaceGeo(verts, NORMALS[fi]),\n      texture: makeFaceTexture(labels[fi], primary),\n    })),\n    [primary, labels],\n  );\n\n  const edges = useMemo(() =>\n    EDGE_PAIRS.map(([a, b]) => ({\n      geo: makeEdgeCylinder(a, b, EDGE_RADIUS, edgeBaseColor),\n      ...edgeTransform(a, b),\n    })),\n    [edgeBaseColor],\n  );\n\n  const sphereGeo = useMemo(() => new THREE.SphereGeometry(EDGE_RADIUS, 8, 8), []);\n\n  // Roll trigger\n  useEffect(() => {\n    if (rollTrigger === 0) return;\n    if (rollTrigger === prevTrigger.current) return;\n    prevTrigger.current = rollTrigger;\n\n    hasReported.current = false;\n    spinning.current = true;\n    spinStart.current = 0;\n\n    const sx = Math.random() < 0.5 ? -1 : 1;\n    const sy = Math.random() < 0.5 ? -1 : 1;\n    const sz = Math.random() < 0.5 ? -1 : 1;\n\n    spinAxis.current\n      .set(\n        sx * (0.5 + Math.random() * 0.5),\n        sy * (0.5 + Math.random() * 0.5),\n        sz * (0.5 + Math.random() * 0.5),\n      )\n      .normalize();\n\n    spinSpeed.current = 14 + Math.random() * 4;\n\n    targetFaceIdx.current = Math.floor(Math.random() * 10);\n    targetQuat.current.copy(TARGET_QUATS[targetFaceIdx.current]);\n  }, [rollTrigger]);\n\n  // Tint faces based on camera-facing direction + flash\n  const tintFaces = () => {\n    if (!groupRef.current) return;\n\n    let flash = 0;\n    if (flashing.current && flashStart.current > 0) {\n      const flashElapsed = performance.now() / 1000 - flashStart.current;\n      const ft = Math.min(flashElapsed / FLASH_DURATION, 1);\n      flash = 1 - ft;\n      if (ft >= 1) flashing.current = false;\n\n      const scalePunch = 1 + 0.15 * Math.sin(ft * Math.PI);\n      groupRef.current.scale.setScalar(scalePunch);\n    }\n\n    for (let i = 0; i < 10; i++) {\n      const mesh = faceMeshRefs.current[i];\n      if (!mesh) continue;\n      worldNormal.current.copy(NORMALS[i]).applyQuaternion(groupRef.current.quaternion);\n      const dot = worldNormal.current.dot(camDir);\n      let brightness = 0.55 + 0.45 * Math.max(0, dot);\n      if (flash > 0) {\n        brightness = brightness + (2.0 - brightness) * flash * 0.6;\n      }\n      (mesh.material as THREE.MeshBasicMaterial).color.setScalar(brightness);\n    }\n  };\n\n  useFrame((_, delta) => {\n    if (!groupRef.current) return;\n\n    tintFaces();\n\n    if (!spinning.current) return;\n\n    if (spinStart.current === 0) {\n      spinStart.current = performance.now() / 1000;\n      settleStart.current = 0;\n    }\n\n    const elapsed = performance.now() / 1000 - spinStart.current;\n\n    if (elapsed < SPIN_DURATION) {\n      const progress = elapsed / SPIN_DURATION;\n      const decay = Math.pow(1 - progress, 1.5);\n      groupRef.current.rotateOnAxis(spinAxis.current, spinSpeed.current * decay * delta);\n    } else {\n      if (settleStart.current === 0) {\n        settleStart.current = performance.now() / 1000;\n        settleStartQuat.current.copy(groupRef.current.quaternion);\n      }\n\n      const settleElapsed = performance.now() / 1000 - settleStart.current;\n      const t = Math.min(settleElapsed / SETTLE_DURATION, 1);\n      const eased = 1 - Math.pow(1 - t, 3);\n\n      groupRef.current.quaternion.copy(settleStartQuat.current).slerp(targetQuat.current, eased);\n\n      if (t >= 1) {\n        spinning.current = false;\n        groupRef.current.quaternion.copy(targetQuat.current);\n\n        if (!hasReported.current) {\n          hasReported.current = true;\n          flashing.current = true;\n          flashStart.current = performance.now() / 1000;\n          onResult(FACE_VALUES[targetFaceIdx.current]);\n        }\n      }\n    }\n  });\n\n  return (\n    <group ref={groupRef} position={[0, -0.15, 0]}>\n      {faceData.map((face, i) => (\n        <mesh key={i} ref={el => { faceMeshRefs.current[i] = el; }} geometry={face.geometry}>\n          <meshBasicMaterial map={face.texture} />\n        </mesh>\n      ))}\n      {edges.map((edge, i) => (\n        <mesh key={`edge-${i}`} geometry={edge.geo} position={edge.pos} quaternion={edge.quat}>\n          <meshBasicMaterial vertexColors />\n        </mesh>\n      ))}\n      {ALL_VERTS.map((v, i) => (\n        <mesh key={`corner-${i}`} geometry={sphereGeo} position={v}>\n          <meshBasicMaterial color={edgeBaseColor} />\n        </mesh>\n      ))}\n    </group>\n  );\n}\n","import { Canvas } from '@react-three/fiber';\nimport TrapezohedronDie from './TrapezohedronDie';\n\ninterface Props {\n  rollTrigger: number;\n  onResult: (result: number) => void;\n  onClick: () => void;\n  primary: string;\n  primaryDark: string;\n}\n\nexport default function D10Scene({ rollTrigger, onResult, onClick, primary, primaryDark }: Props) {\n  return (\n    <Canvas\n      flat\n      camera={{ position: [0, 0, 5.5], fov: 40 }}\n      gl={{ alpha: true, antialias: true }}\n      style={{ background: 'transparent', cursor: 'pointer' }}\n      onClick={onClick}\n    >\n      <ambientLight intensity={0.55} color=\"#ffffff\" />\n      <directionalLight position={[0, 0, 5]} intensity={0.45} color=\"#ffffff\" />\n      <directionalLight position={[3, 5, 5]} intensity={0.15} color=\"#ffffff\" />\n      <TrapezohedronDie\n        rollTrigger={rollTrigger}\n        onResult={onResult}\n        primary={primary}\n        primaryDark={primaryDark}\n      />\n    </Canvas>\n  );\n}\n"],"names":["DEG72","Math","PI","TOP","BOT","EQ","Array","from","length","_","i","a","cos","sin","ALL_VERTS","FACES","FACE_VALUES","NORMALS","map","f","b","c","va","THREE","vb","vc","sub","cross","normalize","computeNormal","EDGE_PAIRS","TARGET_QUATS","verts","fi","normal","cx","cy","cz","up","right","crossVectors","m","makeBasis","transpose","setFromRotationMatrix","camDir","MIN_Y","min","v","MAX_Y","max","parseColor","color","rgbMatch","match","hex","replace","n","parseInt","split","join","contrastText","bg","lum","r","g","s","pow","luminance","makeFaceGeo","geo","pos","Float32Array","norms","x","y","z","uvs","setAttribute","makeFaceTexture","label","primary","size","canvas","document","createElement","width","height","ctx","getContext","fillStyle","fillRect","textColor","font","concat","textAlign","textBaseline","fillText","tex","needsUpdate","makeEdgeCylinder","radius","baseColor","distanceTo","tA","tB","positions","attributes","position","colors","count","tint","getY","TrapezohedronDie","_ref","rollTrigger","onResult","faceLabels","groupRef","useRef","prevTrigger","hasReported","spinning","spinStart","spinAxis","spinSpeed","targetFaceIdx","targetQuat","settleStartQuat","settleStart","flashing","flashStart","labels","String","edgeBaseColor","useMemo","ratio","round","darken","faceMeshRefs","fill","worldNormal","faceData","geometry","texture","edges","_ref2","_objectSpread","mid","clone","add","multiplyScalar","dir","quat","setFromUnitVectors","edgeTransform","sphereGeo","useEffect","current","sx","random","sy","sz","set","floor","copy","useFrame","delta","tintFaces","flash","flashElapsed","performance","now","ft","scalePunch","scale","setScalar","mesh","applyQuaternion","quaternion","dot","brightness","material","elapsed","progress","decay","rotateOnAxis","settleElapsed","t","eased","slerp","_jsxs","ref","children","face","_jsx","el","edge","vertexColors","D10Scene","onClick","primaryDark","Canvas","flat","camera","fov","gl","alpha","antialias","style","background","cursor","intensity"],"sourceRoot":""}